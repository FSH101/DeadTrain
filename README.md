# Призрачная электричка — изометрическое приключение

Пиксельная история в изометрии про ночной поезд и попытку выбраться из него. Игрок
взаимодействует с объектами вагона и пассажирами, выбирает реплики, а последовательность
действий приводит к разным концовкам.

Проект полностью клиентский. Достаточно открыть `index.html` или `train.html` в браузере.

## Как устроено

```
├── css/
│   └── train.css              # Оформление изометрической сцены, объектов и интерфейса
├── js/
│   ├── game/
│   │   ├── dialoguePanel.js   # Пиксельный диалоговый интерфейс
│   │   ├── gameController.js  # Оркестратор: сцены, состояние, эффекты, концовки
│   │   ├── gameState.js       # Состояние игрока: сцена, флаги, завершённые скрипты
│   │   ├── isometricRenderer.js # Отрисовка тайлов и объектов в изометрии
│   │   ├── scriptEngine.js    # Исполнение диалоговых сценариев
│   │   └── worldData.js       # Описание вагонов, объектов, скриптов и финалов
│   └── main.js                # Точка входа, создаёт контроллер
├── index.html                 # Титульный экран
└── train.html                 # Основной экран игры
```

### Состояние и флаги

Игровое состояние (`GameState`) хранит текущую сцену, собранные флаги (фонарик, знание
последовательности и т.д.), посещённые объекты и пройденные скрипты. Флаги отображаются
в правой части хедера и влияют на доступность вариантов в диалогах.

### Скрипты и эффекты

Сюжет описан в `worldData.js`. Каждый объект сцены ссылается на скрипт:

- `type: 'text'` — показывает описание, после кнопки «Далее» переходит к `next`;
- `type: 'choice'` — набор вариантов с условиями (`requires`/`requiresNot`) и эффектами;
- эффекты `setFlag`/`clearFlag` меняют состояние, `goToScene` переключает сцену,
  `triggerEnding` открывает финал.

Скрипты разруливаются `ScriptEngine`, а `GameController` применяет эффекты, обновляет
HUD и перерисовывает сцену.

### Изометрическая сцена

`IsometricRenderer` пересчитывает координаты тайлов и объектов в изометрические, строит
DOM-дерево и применяет пиксельные стили. Активные объекты реагируют на нажатия/тапы.

## Управление и концовки

- Управление заточено под клики или тапы: жми на объекты вагона, чтобы взаимодействовать.
- Порядок действий влияет на финал. Например, без фонарика переход между вагонами
  обрывается в пустоте, а правильная последовательность в щитке открывает быстрый выход.
- Доступно несколько концовок: быстрый выход, рассвет с машинистом, провал в темноту,
  срыв стоп-крана и объятия проводов.

## Запуск

Проект статичен. Открой `index.html`/`train.html` напрямую или обслужи папку любым
простым веб-сервером:

```bash
npx serve .
```

После загрузки титульного экрана нажми «Начать путешествие» и попади в изометрический вагон.
